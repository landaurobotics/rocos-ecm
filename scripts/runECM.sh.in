#!/bin/bash

echo "============EtherCAT Master for Robot=============="
echo "===@Author: Yang Luo                            ==="
echo "===@Create: 2021.07.17 00:05                    ==="
echo "===@Last Modified: 2021.12.2 16:16              ==="
echo "===@Ver: 0.2                                    ==="
echo "==================================================="

INSTANCE=$(lspci -mm | grep -i 'Ethernet controller' | sed -n '$p' | cut -d ' ' -f 1 | awk '$1=$1')

if [ $# -lt 1 ]; then
  echo "The eni.xml will be used as default."
  ENI_FILE=eni.xml
else
  echo "The $1 is used as eni file."
  ENI_FILE="$1"
fi

# Start EcMaster
nice -20 ./@PROJECT_NAME@ -f $ENI_FILE -i8254x $INSTANCE 1 -v 3 -perf -t 0